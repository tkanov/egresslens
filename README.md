# EgressLens

Monitor outbound network activity from Python apps in Docker. Trace connections with `strace`, generate JSONL logs for analysis, and explore results in a web UI.

---

## Prerequisites

- **Docker** - EgressLens runs applications in Docker containers to isolate and trace network activity
- **Python 3.8+** - for running the CLI
- **Linux/macOS** - EgressLens is built with Unix-like systems in mind

---

## Installation

```bash
# Clone the repository, and then
cd egresslens

# Install the CLI
pip install -e .
```

---

## Quick start

Analyze a Python app in 30 seconds:

```bash
egresslens run-app ./sample_app --args "dns example.com"
```

This generates:
- `egresslens-output/egress.jsonl` - network events
- `egresslens-output/run.json` - metadata and statistics
- `egresslens-output/cmd_stdout` - app output

---

## Project structure

- **[cli/](cli/README.md)**  
  Command-line tool for running a user-specified command in a Docker container, tracing its network syscalls with `strace`, and generating JSONL event logs and run metadata. This is the main entrypoint for capturing egress data.

- **[sample_app/](sample_app/README.md)**  
  A tiny Python app used for testing EgressLens. It performs DNS lookups and queries [crt.sh](https://crt.sh/) for certificate transparency entries, providing predictable network activity for demo and test runs.

- **[backend/](backend/README.md)**  
  FastAPI backend *(in progress)* for uploading, aggregating, and serving reports generated by the CLI.

- **[frontend/](frontend/README.md)**  
  React + TypeScript web UI *(in progress)* for exploring egress analysis reports.

---

## Analyzing Python projects

EgressLens provides a `run-app` command for analyzing **Python projects**. This command automatically discovers your app's entry point, installs dependencies, and captures all network activity.

### App structure requirements

Your Python app directory must contain one of these entry points:
- `__main__.py` (run as: `python -m <app_name>`)
- `main.py` (run as: `python main.py`)
- `app.py` (run as: `python app.py`)

**Optional: Automatic dependency installation**
- Include a `requirements.txt` file in your app directory
- Dependencies will be installed automatically before the app runs

### Example

```
my_app/
├── app.py              # Entry point (required)
├── requirements.txt    # Dependencies (optional)
└── other_modules.py    # Additional files
```

### Usage

```bash
# Basic usage
egresslens run-app ./your_python_app

# With arguments
egresslens run-app ./your_python_app --args "arg1 arg2"

# Example with sample_app
egresslens run-app ./sample_app --args "dns example.com"
```

---

